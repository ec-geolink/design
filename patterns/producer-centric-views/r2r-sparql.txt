PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX xml: <http://www.w3.org/XML/1998/namespace>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX geosparql: <http://www.opengis.net/ont/geosparql#>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
PREFIX glv: <http://schema.geolink.org/view/1.0/>
PREFIX gls: <http://schema.geolink.org/1.0/>

## If some triple in the WHERE clause is optional in the data, then use OPTIONAL clause?
## Need to figure out which triple pattenrs oae
## Currently, only construct triples from non-inverse relationship. 

## Based on <http://linked.rvdata.us/page/award/100004>      
## r2r:Award rdfs:subClassOf glv:Award 

CONSTRUCT {
   ?X rdf:type gls:FundingAward .
   _:ar gls:isAgentRoleIn ?X .
   _:ar rdf:type gls:AgentRole .
   _:ar gls:hasAgentRoleType gls:funding_award_sponsor_role .
   _:ar gls:isPerformedBy ?Z .
   ?Z rdf:type gls:Organization . 
   ?X gls:isDescribedBy _:io .
   _:io rdf:type gls:FundingAwardInformationObject .
   _:io gls:hasAwardID ?ID .
   _:io gls:hasAwardTitle ?T .
   _:io gls:seeAlso ?W .
}
FROM <http://address-to-r2r-graph-mapped-to-view>
WHERE {
  ?X rdf:type glv:Award .
  ?X glv:hasSponsor ?Z.
  ?X dcterms:identifier ?ID .
  ?X dcterms:title ?T .
  ?X dcterms:source ?W .
}

## Based on <http://linked.rvdata.us/page/cruise/MGL0901>
## Only partially done .
## Event is for port arrival/departure?
## Fileset, Holding, : not yet done.
## cruise participant relationship is reified, but cruise operator and scheduler are not.

CONSTRUCT {
  ?C rdf:type gls:Cruise .
  ?C gls:isFundedBy ?AW .
  ?C gls:
  _:arop rdf:type gls:AgentRole .
  _:arop gls:isAgentRoleIn ?C .
  _:arop gls:hasAgentRoleType gls:cruise_operator_role
  _:arop gls:isPerformedBy ?OP .
  ?OP rdf:type gls:Organization .  
}
FROM <http://address-to-r2r-graph-mapped-to-view>
WHERE {
  ?C rdf:type glv:Cruise .
  ?C glv:hasAward ?AW .  
  ?C glv:hasCruiseOperator ?OP .
  ?C glv:hasCruiseScheduler ?SCH .
  ?C glv:hasCruiseParticipant ?P .
  ?C glv:hasFileset ?FSET .  
  ?C glv:hasHolding ?HLD .  
  ?C glv:hasProduct ?PROD .  
  ?C glv:hasCruiseTrack ?TRACK .
  ?C glv:hasCruiseEvent ?EV .  
  ?C glv:hasVessel ?V .
  ?C glv:hasVesselName ?VN .
  ?C glv:hasCruiseTypeVoc ?TY .
  
  ?C dcterms:title ?T .
  ?C dcterms:identifier ?ID .
  ?C rdfs:label ?L .
  ?C rdfs:seeAlso ?W .
}

## http://linked.rvdata.us/page/device/100002
## r2r:Device rdfs:subClassOf glv:Device
CONSTRUCT {
}
FROM
WHERE {
  ?D glv:hasDeviceModel ?M .
  ?D glv:hasDeviceVendor ?VEND .
  ?D glv:hasDeviceTypeVocab ?T .
  ?D dcterms:identifier ?ID .
  ?D rdfs:label ?L .
  ?D rdf:type glv:Device
  ## ?D rdf:type ?NERCVOC .
}

## <http://linked.rvdata.us/page/event/100002781>
## This corresponds to arrival/departure from port

CONSTRUCT {
}
FROM <http://address-to-graph-view>
WHERE {
  ?E glv:hasPort ?P .
  ?E glv:hasPortActivityTypeVoc ?A .
  ?E glv:hasTimeStamp ?T .
  ?E rdfs:label ?L .
  ?E rdf:type glv:Event .
}

## <http://linked.rvdata.us/page/fileset/101244>
## r2r:Fileset rdfs:subClassOf glv:DigitalObjectRecord

CONSTRUCT {
} 
FROM
WHERE {
  ?FS glv:hasDevice ?DV .
  ?FS glv:hasFormat ?FMT .
  ?FS dcterms:identifier ?ID .
  ?FS rdfs:label ?L .
  ?FS dcterms:source ?S .
  ?FS dcterms:tableOfContents ?TOC .
  ?FS dcterms:title ?T .
  ?FS rdf:type glv:DigitalObjectRecord .
}

## http://linked.rvdata.us/page/format/100008
CONSTRUCT {
}
FROM
WHERE {
	?FMT dcterms:description ?DESC . ## R2R uses rdfs:description, which is not defined in RDFS
	?FMT dcterms:identifier ?ID .
	?FMT rdfs:label ?L .
	?FMT rdf:type glv:Format .
}

## http://linked.rvdata.us/page/geometry/100004
## are all geometries in R2R actually geo:Point?
CONSTRUCT {
}
FROM
WHERE {
	?GEOM dcterms:identifier ?ID .
	?GEOM rdfs:label ?L .
	?GEOM geo:lat ?LAT .
	?GEOM geo:long ?LONG .
	?GEOM rdf:type geo:Point .
}

## <http://linked.rvdata.us/page/holding/100035>
## r2r:Holding rdfs:subClassOf glv:DigitalObjectRecord

CONSTRUCT {
} 
FROM
WHERE {
  ?H glv:belongsToRepository ?REPO .
  ?H dcterms:identifier ?ID .
  ?H rdfs:label ?L .
  ?H dcterms:source ?S .
  ?H rdf:type glv:DigitalObjectRecord .
}

## http://linked.rvdata.us/page/model/100015
## What is r2r:Model?
CONSTRUCT {
}
FROM
WHERE {
  ?MOD glv:hasVendor ?VEND .
  ?MOD dcterms:identifier ?ID .
  ?MOD rdfs:label ?L .
  ## ?MOD rdf:type r2r:Model .
}


## Based on <http://linked.rvdata.us/page/organization/gov.nsf>
## r2r:Organization rdfs:subClassOf glv:Organization

CONSTRUCT {
  ?O rdf:type gls:Organization .
  ?O gls:isDescribedBy _:io .
  _:io rdf:type gls:OrganizationInformationObject .
  _:io gls:hasCanonicalName ?ID .
  _:io gls:alsoKnownAs ?L .
  _:io gls:alsoKnownAs ?M .  
}
FROM <http://address-to-r2r-graph-mapped-to-view>
WHERE {
  ?O rdf:type glv:Organization
  ?O dcterms:identifier ?ID .
  ?O rdfs:label ?L .
  ?O foaf:name ?M .
}


## http://linked.rvdata.us/page/participant/100005
CONSTRUCT {
}
FROM
WHERE {
  ?P glv:hasAffiliation ?ORG .
  ?P dcterms:identifier ?ID .
  ?P rdfs:label ?L .
  ?P glv:isPerformedBy ?PERS .
  ?P glv:hasParticipantRoleTypeVoc ?ROL .
  ?P rdf:type glv:AgentRole .
}




## http://linked.rvdata.us/page/person/100275

CONSTRUCT {
}
FROM
WHERE {
  ?P dcterms:identifier ?ID .
  ?P rdfs:label ?L .
  ?P foaf:name ?M .
  ?P rdf:type glv:Person
}


## http://linked.rvdata.us/page/port/100006
## r2r:Port rdfs:subClassOf glv:Place
CONSTRUCT {
}
FROM
WHERE {
  ?PORT glv:hasCountryVoc ?C .
  ?PORT glv:hasGeometry ?GEOM .
  ?PORT dcterms:identifier ?ID .
  ?PORT rdfs:label ?L .
  ?PORT rdf:type glv:Place
}

## http://linked.rvdata.us/page/product/100014
## r2r:Product rdfs:subClassOf glv:DigitalObjectRecord
CONSTRUCT {
}
FROM
WHERE {
	?PROD dcterms:identifier ?ID .
	?PROD rdfs:label ?L .
	?PROD dcterms:source ?URL .
	?PROD rdf:type glv:DigitalObjectRecord .
}

## http://linked.rvdata.us/page/report/100455
CONSTRUCT {
}
FROM
WHERE {
	?PROD dcterms:identifier ?ID .
	?PROD rdfs:label ?L .
	?PROD dcterms:source ?URL .
	?PROD rdf:type glv:DigitalObjectRecord .
}

## http://linked.rvdata.us/page/repository/IMLGS
CONSTRUCT {
}
FROM
WHERE {
	?REPO dcterms:identifier ?ID .
	?REPO rdfs:label ?L .
	?REPO foaf:name ?M .  ## This is weird since a repository is not a person.
	?REPO rdf:type glv:Repository .
}

## http://linked.rvdata.us/page/track/MGL0901
## <http://www.opengis.net/ont/sf#LineString> rdfs:subClassOf glv:Geometry 
## Is every track a line string?
CONSTRUCT {
}
FROM
WHERE {
  ?TR geosparql:asWKT ?WKT .
  ?TR rdfs:label ?L .
  ?TR rdf:type glv:Geometry  
}

## http://linked.rvdata.us/page/vessel/33H3
## r2r:Vessel rdfs:subClassOf glv:Vessel

CONSTRUCT {
}
FROM
WHERE {
  ?V glv:hasVesselOperator ?OP .
  ?V glv:hasVesselOwner ?OW .
  ?V skos:exactMatch ?NERCVESSEL .
  ?V dcterms:identifier ?ID .
  ?V rdfs:label ?L .
  ?V rdf:type glv:Vessel  
  ?V rdf:type ?NERCVESSELTYPE .
}

